---
title: "Data Visualization"
---

```{r ,echo=FALSE, message=FALSE, warning=FALSE}
library(flipbookr)
library(tidyverse)
library(ggplot2)
library(forecast)
library(astsa) 
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(tidyverse)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
library(dplyr)
```

# Overview

When there are enough data gathered through the multiple data sources discussed in the previous section, it is time to do some data visualizations to obtain a better understanding of each data set with plots. There are two main sections for visualization, the first one is financial data, the stock prices for both tech companies and the cryptocurrency, and the other is economic data, such as GPD and unemployment rate. A series of data visualization plots are created by using plotly and ggplot.

# Stock Prices for Top Tech Companies

```{r,echo=FALSE}
amzn <- read.csv("./data/yahoo/AMZN.csv")
goog <- read.csv("./data/yahoo/GOOG.csv")
msft <- read.csv("./data/yahoo/MSFT.csv")
aapl <- read.csv("./data/yahoo/AAPL.csv")
tsla <- read.csv("./data/yahoo/TSLA.csv")
meta <- read.csv("./data/yahoo/META.csv")

colnames(amzn)[6] = "AMZN"
colnames(goog)[6] = "GOOG"
colnames(msft)[6] = "MSFT"
colnames(aapl)[6] = "AAPL"
colnames(meta)[6] = "META"
colnames(tsla)[6] = "TSLA"

amzn$Date <- as.Date(amzn$Date, "%Y-%m-%d")
meta$Date <- as.Date(meta$Date, "%Y-%m-%d")
tsla$Date <- as.Date(tsla$Date, "%Y-%m-%d")
goog$Date <- as.Date(goog$Date, "%Y-%m-%d")
aapl$Date <- as.Date(aapl$Date, "%Y-%m-%d")
msft$Date <- as.Date(msft$Date, "%Y-%m-%d")
```

```{r,echo=FALSE}
df <- amzn %>% inner_join(meta, by = c('Date'))
df <- df[-c(2:5,7:11, 13)]
df <- df %>% inner_join(tsla, by=c('Date'))
df <- df[-c(4:7,9)]
df <- df %>% inner_join(msft, by=c("Date"))
df <- df[-c(5:8,10)]
df <- df %>% inner_join(aapl, by=c('Date'))
df <- df[-c(6:9,11)]
df <- df %>% inner_join(goog, by=c('Date'))
stock <- df[-c(7:10,12)]

#head(stock)
```

The plot below shows the stock prices for the top 5 tech companies in the world plus Meta (Meta is in top 10, but is included here for specific interest) from the last half of the year of 2012 to the end of 2022. The plot is generated by ggplot and on top of that with ggplotly creating an interactive plot for hovering over at different time period. Different color of lines represent the different stock prices for each company. It is clear that as time goes by, all the stock prices for the six tech companies have had significant increases, having summits at around the last quarter of 2021 and then plummeted quickly after the summits, especially for Meta, Tesla, and Microsoft. There were not clear observable seasonality from this plot, but the trends for the six stock prices are clearly increasing over time with some fluctuations.

The shares of Meta closed at \$97.94 on October 2022, the lowest price since 2016. What happened to Meta is that its parent company of Facebook reported quarterly revenue of \$27.7 billion, which is a decline of more than 4% year over year, so as its profit plummeted 52% to \$4.4 billion. Also, Meta CEO Mark Zuckerberg reiterated his commitment to spending billions of dollars developing the metaverse, which expects to be continued to increase spending. More importantly, it's been hurt by competition from rivals such as TikTok, and a broad slowdown in online advertisement spending and challenges from Apple's iOS privacy update.

```{r,echo=FALSE}
g<- ggplot(stock, aes(x=Date)) +
  geom_line(aes(y=AMZN, colour="AMZN"))+
  geom_line(aes(y=META, colour="META"))+
  geom_line(aes(y=TSLA, colour="TSLA"))+
  geom_line(aes(y=GOOG, colour="GOOG"))+
  geom_line(aes(y=AAPL, colour="AAPL"))+
  geom_line(aes(y=MSFT, colour="MSFT"))+
   labs(
    title = "Stock Prices for Top Market Capitalization Tech Companies",
    subtitle = "From 2012-2022",
    x = "Date",
    y = "Adjusted Closing Prices")+
    guides(colour=guide_legend(title="Tech Companies")) 


ggplotly(g) %>%
  layout(hovermode = "x")
```

# Stock Prices for Top Cryptocurrency

```{r,echo=FALSE}
bit <- read.csv("./data/kaggle/BTC-USD.csv")
ether <- read.csv("./data/kaggle/ETH-USD.csv")

bit$Date <- as.Date(bit$Date, "%Y-%m-%d")
ether$Date <- as.Date(ether$Date, "%Y-%m-%d")

#head(bit)
#head(ether)
```

Below are two separate plots for two most popular cryptocurrencies, Bitcoin and Ethereum. They are created in different plots instead of being together due to the huge differences in stock prices for a long time period, and that could weakens the clear price changes for Ethereum, which has a much lower prices than that of Bitcoin. The time span for Bitcoin is 2014 to 2022 in the plot created by plotly, and the time span for Ethereum is 2015 to 2022 in the plot created by plotly. There were not clear observable seasonality from both plots, but the trends are clearly increasing over time with some fluctuations.

There are some clear huge increases and drops for both Bitcoin and Ethereum during 2021 and 2022. Cryptocurrency became massively popular during the pandemic months. By creating wealth through high returns with tokens, the space attracted users by promising generous returns on investment. While 2021 created many crypto success stories, with regular people becoming millionaires, 2022 has reversed course as trillions of dollars have been wiped out of the space. Cryptocurrency peaked in November 2021 and has experienced a meteoric collapse since then, with Bitcoin dropping in value from roughly \$68,000 to below \$20,000. The reason is that the industry was plagued by macroeconomic pressures, scandales and meltdowns that wiped out fortunes seemingly overnight.

```{r,echo=FALSE}
# plot for bitcoin
fig <- plot_ly(bit, x = ~Date, y = ~Adj.Close, type = 'scatter', mode = 'lines')

fig <- fig %>% layout(title = "Bitcoin Price from 2014 to 2022", yaxis=list(title ="Adjusted Close Price"))
fig
```

```{r,echo=FALSE}
# plot for ether
fig1 <- plot_ly(ether, x = ~Date, y = ~Adj.Close, type = 'scatter', mode = 'lines')

fig1 <- fig1 %>% layout(title = "Ethereum Price from 2015 to 2022", yaxis=list(title ="Adjusted Close Price"))
fig1
```

```{r,echo=FALSE}
#amzn1 <- amzn[amzn$Date > "2017-12-01",]
#figc <- amzn1 %>% plot_ly(x = ~Date, type="candlestick",
         # open = ~Open, close = ~AMZN,
         # high = ~High, low = ~Low) 
#figc <- figc %>% layout(title = "Candlestick Chart for Amazon for Recent 5 Years")

#figc
```

# Economic Data Visualization

```{r,echo=FALSE}
gdp <- read.csv("./data/fred/GDP.csv")
gdp <- gdp[gdp$DATE > "2011-12-31",]
gdp$DATE <- as.Date(gdp$DATE, "%Y-%m-%d")

cpi <- read.csv("./data/fred/CPI.csv")
cpi <- cpi[cpi$DATE > "2011-12-31",]
cpi$DATE <- as.Date(cpi$DATE, "%Y-%m-%d")

unrate <- read.csv("./data/fred/UNRATE.csv")
unrate <- unrate[unrate$DATE > "2011-12-31",]
unrate$DATE <- as.Date(unrate$DATE, "%Y-%m-%d")

#head(cpi)
#head(gdp)
#head(unrate)
```

```{r,echo=FALSE}
df1 <- gdp %>% inner_join(cpi, by = c('DATE'))
econ <- df1 %>% inner_join(unrate, by =c('DATE'))
colnames(econ)[1] = "Date"
colnames(econ)[3] = "CPI"
#head(econ)
```

After having an overview and understanding about the financial data collected above, now let's dive deep into the economic data sets collected from Fred Economic Data. There are three economic data sets: Gross Domestic Product (GDP), Consumer Price Index (CPI) and unemployment rate. For each data set, ggplot and ggplotly were used to visualize the data from 2012 to 2022. They were not in the same plot because of different units, one is in dollars, one is the index with the base of year 2015, the other one is a seasonally adjusted percentage. Both of the GDP and CPI have a clear increasing trend, while the unemployment rate has a decreasing trend. While the exception of the COVID-19 pandemic seriously impacted the GDP and unemployment rate at the second quarter of 2020, the CPI did not have a huge negative impact from that, because the pandemic has a positive rate of inflation on CPI.

```{r,echo=FALSE}
g1<- ggplot(econ, aes(x=Date)) +
  geom_line(aes(y=GDP, colour="GDP"))+
   labs(
    title = "Gross Domestic Product in the U.S. from 2012 to 2022",
    subtitle = "From 2012-2022",
    x = "Date",
    y = "Billions of Dollars")+
    guides(colour=guide_legend(title="GDP")) 

ggplotly(g1) %>%
  layout(hovermode = "x")
```

```{r,echo=FALSE}
g2<- ggplot(econ, aes(x=Date)) +
  geom_line(aes(y=CPI, colour="CPI"))+
   labs(
    title = "Consumer Price Index: All Items for the U.S. from 2012 to 2022",
    subtitle = "From 2012-2022",
    x = "Date",
    y = "Index 2015=100")+
    guides(colour=guide_legend(title="CPI")) 

ggplotly(g2) %>%
  layout(hovermode = "x")
```

```{r,echo=FALSE}
g3<- ggplot(econ, aes(x=Date)) +
  geom_line(aes(y=UNRATE, colour="unrate"))+
   labs(
    title = "Unemployment Rate in the U.S. from 2012 to 2022",
    subtitle = "From 2012-2022",
    x = "Date",
    y = "Percent (seasonally adjusted)")+
    guides(colour=guide_legend(title="UNRATE")) 

ggplotly(g3) %>%
  layout(hovermode = "x")
```

# Works Cited

Sofia Pitt, Meta shares plunge 24% to the lowest price since 2016, CNBC, Oct 27, 2022, https://www.cnbc.com/2022/10/27/meta-stock-falls-23percent-on-earnings-miss-analyst-downgrades.html

Q.ai, What Happened To Crypto? How The House Of Cards Is Falling, Forbes, Dec 18, 2022, https://www.forbes.com/sites/qai/2022/12/18/what-happened-to-crypto-how-the-house-of-cards-is-falling/?sh=534e724339c2
